import{j as e,m as K}from"./ui-BCLI9ZVX.js";import{a as de,r as h,R as ne}from"./vendor-DJ1oPbzn.js";import{M as V,r as q}from"./markdown-pkb9tii-.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const o of p.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function c(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function u(d){if(d.ep)return;d.ep=!0;const p=c(d);fetch(d.href,p)}})();var oe,te=de;oe=te.createRoot,te.hydrateRoot;const me="/apcontract",Z=async(i,f="",c=!0,u)=>{console.log("chatWithDraftAgent",{session_id:i,query:f,is_interrupt:c,idea_structuring:u}),await new Promise(d=>setTimeout(d,1e3));try{const d=await fetch(`${me}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:i,query:f,is_interrupt:c,idea_structuring:u})});if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const p=d.body.getReader(),o=new TextDecoder;let n="";for(;;){const{done:l,value:v}=await p.read();if(l)break;const w=o.decode(v).split(`
`);for(const b of w)if(b.startsWith("data: ")){const S=b.slice(6);if(S.trim()){n=S,p.cancel();break}}if(n)break}if(console.log("chatWithDraftAgent result=====>",n),!n||n.trim()==="")throw new Error("Empty response from server");return n}catch(d){throw console.error("Error in chatWithDraftAgent:",d),d}},le=h.createContext();function ue({children:i}){const[f,c]=h.useState([]),[u,d]=h.useState([]),[p,o]=h.useState({}),[n,l]=h.useState(""),[v,j]=h.useState("idea-submission"),[w,b]=h.useState([]),[S,t]=h.useState(""),[m,s]=h.useState([]),[x,r]=h.useState(""),[a,k]=h.useState(""),[_,O]=h.useState(""),[I,L]=h.useState(!1),[B,M]=h.useState(!1),[A,T]=h.useState(null),[F,g]=h.useState(!1);console.log({loading:F}),h.useEffect(()=>{w.length>0&&w.forEach(E=>{o(z=>({...z,[E.section_heading]:"Currently we have not completed this section."}))})},[w]);const N={idea:a,title:x,all_sections:w,user_context:A},C=async()=>{if(console.log("handleSend called"),!n.trim())return;const E={role:"user",content:n},z=[...f,E];c(z);const J=n;l("");try{if(g(!0),v==="idea-submission"){let y=await Z(S,J,!1,N);try{y.startsWith("data: ")?y=JSON.parse(y==null?void 0:y.slice(6)):y=JSON.parse(y)}catch(R){throw console.error("JSON parsing error:",R),console.error("Raw response:",y),new Error(`Failed to parse server response: ${R.message}`)}console.log("ðŸš€ ~ handleSend ~ res:",y),y.type==="interrupt"?y.action==="get_question_response"?(c(R=>[...R,{role:"assistant",content:y.question,reason:y.reason,section:y.section,subsection:y.subsection}]),j("question-response")):y.action==="get_structure_review"&&(t(y.session_id),b(y.all_sections),r(y.title),k(y.idea),j("structure-review")):y.type==="end"&&console.log("Document completed:",y)}else if(v==="question-response"){let y=await Z(S,J,!0,N);try{y.startsWith("data: ")?y=JSON.parse(y==null?void 0:y.slice(6)):y=JSON.parse(y)}catch(R){throw console.error("JSON parsing error:",R),console.error("Raw response:",y),new Error(`Failed to parse server response: ${R.message}`)}console.log("ðŸš€ ~ handleSend ~ question response:",y),y.type==="interrupt"&&(y.action==="get_question_response"?c(R=>[...R,{role:"assistant",content:y.question,reason:y.reason,section:y.section,subsection:y.subsection}]):y.action==="get_structure_review"&&(t(y.session_id),b(y.all_sections),r(y.title),k(y.idea),j("structure-review")))}}catch(y){const R=y.message||"An unexpected error occurred";console.error("Error during chat interaction:",R);let G="I apologize, but I encountered an error. Please try again.";R.includes("Failed to fetch")||R.includes("Network Error")?G="Network connection error. Please check your internet connection and try again.":R.includes("Empty response")?G="The server returned an empty response. Please try again.":R.includes("HTTP error")&&(G="Server connection error. Please ensure the backend server is running."),c([...z,{role:"assistant",content:G}])}finally{g(!1)}},D=async()=>{var J,y,R,G;if(!n.trim()&&_&&!I)return;g(!0);let E=[...u];if(_&&!I){const $={role:"user",content:n};E=[...u,$],d(E)}const z=I?p[_]:n;l("");try{let $=await Z(S,z,!0,N);L(!1);try{$.startsWith("data: ")?$=JSON.parse($==null?void 0:$.slice(6)):$=JSON.parse($)}catch(U){throw console.error("JSON parsing error:",U),console.error("Raw response:",$),new Error(`Failed to parse server response: ${U.message}`)}console.log("ðŸš€ ~ submitIdea ~ res:",$);const{action:H,section:X,question:ie,reason:ce,draft:Y}=$;if(H!="generate_document"&&O(X),H=="generate_document"&&((J=$==null?void 0:$.final_state)!=null&&J.all_drafts))o((y=$==null?void 0:$.final_state)==null?void 0:y.all_drafts),M(!0),d([...E,{role:"assistant",content:"## **We have completed all the sections. Download the draft from draft section.**"}]);else if(H=="get_question_response"){const U={...p,[X]:Y};console.log("draft ===>",U),d([...E,{role:"assistant",content:`${ie}`,reason:`${ce}`}]),Y&&Y.length>0&&o(U)}else if(H=="get_reviewed_section_draft"){L(!0),d([...E,{role:"assistant",content:`Please check the **${_}** section draft.

If you like the draft click on the **Continue** button, or edit the draft`}]);const U={...p,[X]:Y};console.log("draft ===>",U),o(U)}else H=="get_review_changes"&&d([...E,{role:"assistant",content:"Please reply with the changes you want to make."}])}catch($){d([...E,{role:"assistant",content:"I apologize, but I encountered an error. Please try again."}]);const H=((G=(R=$.response)==null?void 0:R.data)==null?void 0:G.message)||"An unexpected error occurred";console.error("Error during chat interaction:",H)}finally{g(!1)}};console.log("draft",{draftMessages:u,drafts:p});const P=()=>{j("idea-submission"),b([]),t(""),s([]),r(""),c([]),d([]),o({}),O(""),l(""),g(!1),k(""),M(!1),L(!1),T(null)};return e.jsx(le.Provider,{value:{messages:f,setMessages:c,input:n,setInput:l,handleSend:C,handleNewChat:P,initialChatStep:v,setInitialChatStep:j,contractSections:w,setContractSections:b,titles:m,setTitles:s,selectedTitle:x,setSelectedTitle:r,session_id:S,setSession_id:t,handleDraftChat:D,draftMessages:u,drafts:p,setDrafts:o,activeSection:_,loading:F,rephrasedIdea:a,setRephrasedIdea:k,isReviewedSectionDraftActive:I,setIsReviewedSectionDraftActive:L,isDraftingComplete:B,userContext:A,setUserContext:T},children:i})}function W(){return h.useContext(le)}function xe(){const{contractSections:i,setContractSections:f,setInitialChatStep:c}=W(),[u,d]=h.useState(new Set),[p,o]=h.useState(null),[n,l]=h.useState(null);console.log("ContractSectionDisplayComponent");const v=["bg-blue-50 border-blue-200 hover:bg-blue-100","bg-green-50 border-green-200 hover:bg-green-100","bg-purple-50 border-purple-200 hover:bg-purple-100","bg-orange-50 border-orange-200 hover:bg-orange-100"],j=m=>{const s=new Set(u);s.has(m)?s.delete(m):s.add(m),d(s)},w=m=>{f(i.filter((s,x)=>x!==m))},b=(m,s,x)=>{const r=[...i];r[m][s]=x,f(r)},S=(m,s)=>{if(i[m].subsections.length<=1){alert("At least one subsection is required");return}const r=[...i];r[m].subsections=r[m].subsections.filter((a,k)=>k!==s),f(r)},t=(m,s,x,r)=>{const a=[...i];a[m].subsections[s][x]=r,f(a)};return e.jsx("div",{className:"min-h-screen p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("p",{className:"text-lg text-gray-600",children:"Based on idea provided, we have suggest the following sections and subsections."})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i.map((m,s)=>{var x;return e.jsxs("div",{className:`${v[s%v.length]} border-2 rounded-xl p-6 shadow-md ${u.has(s)?"":"max-h-48"} `,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{onClick:()=>j(s),className:"text-gray-600 hover:text-gray-800",children:u.has(s)?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"purple",children:e.jsx("path",{d:"M5 8l7 11 7-11z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"purple",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(s),className:"text-purple-600 hover:text-purple-800 text-sm",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"purple",children:e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"})})}),e.jsx("button",{onClick:()=>w(s),className:"text-red-600 hover:text-red-800 text-sm",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"#dc2626",children:e.jsx("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})]}),p===s?e.jsxs("div",{className:"space-y-4 text-left",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold block text-sm font-medium text-gray-700 mb-1",children:"Section Heading"}),e.jsx("input",{type:"text",value:m.section_heading,onChange:r=>b(s,"section_heading",r.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold block text-sm font-medium text-gray-700 mb-1",children:"Section Purpose"}),e.jsx("textarea",{value:m.section_purpose,onChange:r=>b(s,"section_purpose",r.target.value),className:"w-full p-2 border border-gray-300 rounded-md h-20"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(null),className:"startPocButton",children:"Save"}),e.jsx("button",{onClick:()=>o(null),className:"bg-gray-50 border border-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:m.section_heading}),e.jsx("p",{className:"text-gray-600 mb-4",children:m.section_purpose})]}),u.has(s)&&e.jsxs("div",{className:"mt-6 pt-4 border-t-2",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h4",{className:"text-lg font-medium text-gray-800",children:"Subsections"})}),e.jsx("div",{className:"space-y-3",children:(x=m==null?void 0:m.subsections)==null?void 0:x.map((r,a)=>e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"flex-1",children:n===`${s}-${a}`?e.jsxs("div",{className:"space-y-3 text-left",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold block text-sm font-medium text-gray-700 mb-1",children:"Subsection Heading"}),e.jsx("input",{type:"text",value:r.subsection_heading,onChange:k=>t(s,a,"subsection_heading",k.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold block text-sm font-medium text-gray-700 mb-1",children:"Subsection Definition"}),e.jsx("textarea",{value:r.subsection_definition,onChange:k=>t(s,a,"subsection_definition",k.target.value),className:"w-full p-2 border border-gray-300 rounded-md h-16"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l(null),className:"bg-green-600 text-white px-3 py-1 rounded-lg text-sm hover:bg-green-700",children:"Save"}),e.jsx("button",{onClick:()=>l(null),className:"bg-gray-50 border border-gray-200 text-gray-700 px-3 py-1 rounded-lg text-sm hover:bg-gray-400",children:"Cancel"})]})]}):e.jsxs("div",{className:"text-left",children:[e.jsx("h5",{className:"font-semibold text-gray-800 mb-1",children:r.subsection_heading}),e.jsx("p",{className:"text-gray-600 text-sm",children:r.subsection_definition})]})}),n!==`${s}-${a}`&&e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>l(`${s}-${a}`),className:"text-purple-600 hover:text-purple-800 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>S(s,a),className:"text-red-600 hover:text-red-800 text-sm",children:"Delete"})]})]})},a))})]})]},s)})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("div",{className:"flex gap-6 items-center justify-center",children:e.jsx("button",{className:"startPocButton",onClick:()=>c("done"),children:"Start Drafting Contract"})})})]})})}function se(){const{messages:i,input:f,setInput:c,handleSend:u,handleNewChat:d,initialChatStep:p,contractSections:o,selectedTitle:n,rephrasedIdea:l,setSelectedTitle:v,setRephrasedIdea:j,loading:w}=W(),b=h.useRef(null);console.log({loading:w}),h.useEffect(()=>{var t;(t=b.current)==null||t.scrollIntoView({behavior:"smooth"})},[i,w]);const S=async(t,m)=>{const s=t.target.textContent;try{m==="title"?v(s):j(s)}catch(x){console.error(`Error updating ${m}:`,x)}};return console.log("messages:",i),e.jsxs("div",{className:"chat-container",children:[i.length==0&&e.jsxs("div",{className:"flex flex-col items-center justify-center align-middle text-center",style:{minHeight:"500px"},children:[e.jsx("h1",{className:"text-5xl font-bold mb-4 bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"Contract Generation Platform"}),e.jsx("h2",{className:"chat-title",children:"Transforming Concepts into Professional Contracts"})]}),i.length>0&&e.jsx("div",{className:"chat-scroll",children:e.jsx("div",{className:"chat-messages",children:e.jsxs(ne.Fragment,{children:[i.length>0&&e.jsx("div",{className:"chat-bubble user",children:e.jsx(V,{remarkPlugins:[q],children:i[0].content})}),w&&e.jsx("div",{className:"chat-bubble assistant",children:e.jsxs("div",{className:"typing-animation",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})}),n.length>0&&e.jsx("div",{className:"chat-bubble assistant",id:"selectedTitle",contentEditable:!0,suppressContentEditableWarning:!0,onBlur:t=>{t.target.textContent!==n&&S(t,"title")},children:e.jsx(V,{remarkPlugins:[q],children:`### **${n}**`})}),l.length>0&&e.jsx("div",{className:"chat-bubble assistant",id:"rephrasedIdea",contentEditable:!0,suppressContentEditableWarning:!0,onBlur:t=>{t.target.textContent!==l&&S(t,"idea")},children:e.jsx(V,{remarkPlugins:[q],children:l})}),o.length>0&&e.jsx("div",{className:"flex flex-col items-start justify-start",children:e.jsx(xe,{})})]})})}),e.jsxs(K.div,{className:"chat-input-box",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("textarea",{placeholder:p=="idea-submission"?"What problem are you interested in solving?":"",value:f,onChange:t=>{c(t.target.value),t.target.style.height="auto",t.target.style.height=`${Math.min(Math.max(t.target.scrollHeight,60),150)}px`},onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),u())},className:"chat-input",style:{resize:"none",minHeight:"60px",maxHeight:"150px",overflow:"auto"}}),e.jsx("button",{onClick:u,className:"send-button",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"send-icon",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21l16.5-9L3.75 3v7.5l11.25 1.5-11.25 1.5V21z"})})})]})]})}function he({steps:i,title:f}){const{activeSection:c,isDraftingComplete:u}=W(),d=(p,o)=>{if((p.section_heading||p.title)===c)return"current";if(c){const l=i.findIndex(v=>(v.section_heading||v.title)===c);if(l!==-1&&o<l||u)return"completed"}return"upcoming"};return e.jsx("div",{className:"bg-transparent shadow-sm",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-center",children:i&&i.length>0?i.map((p,o)=>{const n=d(p,o);return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                        flex items-center justify-center w-6 h-6 rounded-full 
                        ${n==="completed"||u?" text-green-500 ring-2 ring-green-700":n==="current"?" text-purple-700 ring-2 ring-purple-700":"bg-gray-100 text-gray-600"}
                        font-semibold text-sm transition-colors duration-200
                      `,children:n==="completed"||u?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):o+1}),e.jsx("span",{className:`
                        mt-2 text-xs font-medium text-capitalize
                        ${n==="completed"||u?"text-green-600":n==="current"?"text-purple-800":"text-gray-500"}
                      `,children:p.section_heading||p.title})]}),o<i.length-1&&e.jsx("div",{className:`
                        h-0.5 w-40 mx-2
                        ${n==="completed"||u?"bg-green-500":n==="current"?"bg-purple-500":"bg-gray-200"}
                      `})]},o)}):e.jsx("div",{className:"text-gray-500",children:"No steps available"})})})})}const ge="modulepreload",pe=function(i){return"/contract-gen/"+i},re={},ee=function(f,c,u){let d=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),n=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));d=Promise.allSettled(c.map(l=>{if(l=pe(l),l in re)return;re[l]=!0;const v=l.endsWith(".css"),j=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${j}`))return;const w=document.createElement("link");if(w.rel=v?"stylesheet":ge,v||(w.as="script"),w.crossOrigin="",w.href=l,n&&w.setAttribute("nonce",n),document.head.appendChild(w),v)return new Promise((b,S)=>{w.addEventListener("load",b),w.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${l}`)))})}))}function p(o){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=o,window.dispatchEvent(n),!n.defaultPrevented)throw o}return d.then(o=>{for(const n of o||[])n.status==="rejected"&&p(n.reason);return f().catch(p)})},fe=async(i,f)=>{const{Document:c,Packer:u,Paragraph:d,TextRun:p}=await ee(async()=>{const{Document:b,Packer:S,Paragraph:t,TextRun:m}=await import("./index-C61u3LdB.js");return{Document:b,Packer:S,Paragraph:t,TextRun:m}},[]),o=(b,S)=>{const t=[];t.push(new d({children:[new p({text:b,bold:!0,color:"2F5496",size:32,font:"Calibri"})],spacing:{after:200}}));const m=S.split(/\n+/).filter(Boolean);for(const s of m)t.push(new d({children:[new p({text:s,size:22,font:"Calibri"})],spacing:{after:200,line:276}}));return t},n=new c({sections:[{properties:{},children:Object.entries(i).flatMap(([b,S])=>o(b,S))}]}),l=await u.toBlob(n),v=window.URL.createObjectURL(l),j=document.createElement("a"),w=f||"draft";j.href=v,j.download=`${w}.docx`,document.body.appendChild(j),j.click(),document.body.removeChild(j)},be=()=>{const{drafts:i,setDrafts:f,contractSections:c,activeSection:u,isDraftingComplete:d,selectedTitle:p}=W(),[o,n]=h.useState({}),l=h.useRef({}),v=h.useRef({}),j=h.useRef(null),[w,b]=h.useState(!1),[S,t]=h.useState(null);h.useEffect(()=>{const s=JSON.parse(localStorage.getItem("savedIdeas")||"{}"),x=`${p}_${Object.keys(i).length}`;s[x]&&(b(!0),t(s[x]))},[p,i]);const m=s=>{n(x=>({[s]:!x[s]}))};return h.useEffect(()=>{u&&n(()=>({[u]:!0}))},[u]),h.useLayoutEffect(()=>{if(u&&o[u]&&v.current[u]&&j.current){const s=v.current[u],x=j.current,r=s.offsetTop,a=x.offsetTop,_=r-a-20;setTimeout(()=>{x.scrollTo({top:_,behavior:"smooth"})},150)}},[u,o,i]),e.jsxs("div",{ref:j,className:"pl-3 w-full",style:{maxWidth:"1024px",margin:"0 auto",height:"75vh",overflowY:"auto"},children:[d&&e.jsx("div",{children:e.jsx("h2",{style:{fontSize:"20px",fontWeight:"bold",color:"#1F2937",marginBottom:"16px"},children:"Contract Document - Ready for Review"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:c.map((s,x)=>e.jsxs("div",{ref:r=>l.current[s==null?void 0:s.section_heading]=r,style:{borderRadius:"16px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",border:"1px solid #E5E7EB",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"16px",cursor:"pointer",borderBottom:"1px solid #F3F4F6"},onClick:()=>m(s==null?void 0:s.section_heading),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{className:"flex flex-col items-start text-left",children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",color:"#1F2937"},children:s==null?void 0:s.section_heading}),e.jsx("div",{className:"text-left",style:{fontSize:"12px",fontWeight:"600",color:"#1F2937"},children:s==null?void 0:s.section_purpose})]}),o[s==null?void 0:s.section_heading]?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"purple",children:e.jsx("path",{d:"M5 8l7 11 7-11z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"purple",children:e.jsx("path",{d:"M8 5v14l11-7z"})})]})}),o[s==null?void 0:s.section_heading]&&e.jsx("div",{ref:r=>v.current[s==null?void 0:s.section_heading]=r,style:{padding:"24px"},children:e.jsx("div",{style:{position:"relative"},children:o[`${s==null?void 0:s.section_heading}-edit`]?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("textarea",{value:i[s==null?void 0:s.section_heading]||"",onChange:r=>f(a=>({...a,[s==null?void 0:s.section_heading]:r.target.value})),style:{width:"100%",minHeight:"300px",padding:"8px",border:"1px solid #E5E7EB",borderRadius:"4px",resize:"vertical"}}),e.jsx("button",{onClick:r=>{r.stopPropagation(),n(a=>({...a,[`${s==null?void 0:s.section_heading}-edit`]:!1}))},style:{cursor:"pointer",fontSize:"14px",background:"linear-gradient(to right, #c59c51, #eab308)",border:"none",padding:"8px",borderRadius:"9999px",color:"white",marginTop:"10px"},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}):e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("div",{className:"text-left w-full",children:e.jsx(V,{remarkPlugins:[q],children:i[s==null?void 0:s.section_heading]})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),n(a=>({...a,[`${s==null?void 0:s.section_heading}-edit`]:!0}))},style:{cursor:"pointer",fontSize:"14px",background:"linear-gradient(to right, #c59c51, #eab308)",border:"none",padding:"8px",borderRadius:"9999px",color:"white"},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4Z"})]})})]})})})]},x))}),d&&e.jsx("div",{style:{marginTop:"32px",padding:"16px",borderTop:"1px solid #E5E7EB"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px"},children:[w?e.jsx("div",{style:{padding:"12px 24px",borderRadius:"8px",background:"#E5E7EB",color:"#6B7280",fontWeight:"600",fontSize:"14px",textAlign:"center"},children:"âœ… Contract Saved to Catalog"}):e.jsx("button",{style:{cursor:"pointer",fontSize:"14px",background:"linear-gradient(to right, #10B981, #059669)",border:"none",padding:"12px 24px",borderRadius:"8px",color:"white",fontWeight:"600"},onClick:async()=>{try{const s=Object.entries(i).map(([r,a])=>`## ${r}

${a}`).join(`

`),x=await fetch("/apcontract/contracts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:p||"Untitled Idea",idea:s,drafts:i,status:"submitted",metadata:{is_poc_document:!0,sections_count:Object.keys(i).length,created_at:new Date().toISOString(),submitted_by:"User",department:"General",summary_type:"complete_poc_document"}})});if(x.ok){const r=await x.json();b(!0),t(r.session_id);const a=JSON.parse(localStorage.getItem("savedIdeas")||"{}"),k=`${p}_${Object.keys(i).length}`;a[k]=r.session_id,localStorage.setItem("savedIdeas",JSON.stringify(a)),alert("Contract saved successfully! It will now appear in the Contract Catalog for review."),console.log("Contract saved with session ID:",r.session_id)}else{const r=await x.text();console.error("Save failed:",r),alert("Failed to save idea. Please check if the backend server is running.")}}catch(s){console.error("Error saving idea:",s),alert("Error saving idea. Please check if the backend server is running at http://localhost:8000")}},children:"Save Contract to Catalogue"}),e.jsx("button",{style:{cursor:"pointer",fontSize:"14px",background:"linear-gradient(to right, #c59c51, #eab308)",border:"none",padding:"12px 24px",borderRadius:"8px",color:"white",fontWeight:"600"},onClick:()=>fe(i,p),children:"Download"})]})})]})};function ve(){const{input:i,setInput:f,handleDraftChat:c,draftMessages:u,loading:d,isReviewedSectionDraftActive:p}=W(),o=h.useRef(null);return h.useEffect(()=>{var n;(n=o.current)==null||n.scrollIntoView({behavior:"smooth"})},[u,d]),h.useEffect(()=>{console.log("this runs twise"),c()},[]),e.jsxs("div",{className:"flex flex-col h-full w-full pr-3",children:[e.jsx("div",{className:"chat-scroll",children:e.jsx("div",{className:"chat-messages",children:e.jsxs(ne.Fragment,{children:[u.map((n,l)=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:`chat-bubble ${n.role==="user"?"user":"assistant"}`,children:[(n==null?void 0:n.reason)&&e.jsxs("span",{className:"tooltip",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",stroke:"purple","stroke-width":"1.5",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"8","stroke-linecap":"round"}),e.jsx("line",{x1:"12",y1:"12",x2:"12",y2:"16","stroke-linecap":"round"})]}),e.jsx("span",{className:"tooltip-content",children:n==null?void 0:n.reason})]}),e.jsx(V,{remarkPlugins:[q],children:n.content})]},l)})),p&&e.jsx("button",{className:"startPocButton",onClick:()=>c(),children:"Continue"}),d&&e.jsx("div",{className:"chat-bubble assistant",children:e.jsxs("div",{className:"typing-animation",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})}),e.jsx("div",{ref:o})]})})}),e.jsxs(K.div,{className:"chat-input-box mx-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("textarea",{placeholder:u.length>0?"":"Let's start by sharing your project idea or business concept here.",value:i,onChange:n=>{f(n.target.value),n.target.style.height="auto",n.target.style.height=`${Math.min(Math.max(n.target.scrollHeight,60),150)}px`},onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),c())},className:"chat-input",style:{resize:"none",minHeight:"60px",maxHeight:"150px",overflow:"auto"}}),e.jsx("button",{onClick:c,className:"send-button",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"send-icon",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21l16.5-9L3.75 3v7.5l11.25 1.5-11.25 1.5V21z"})})})]})]})}function ae(){const{initialChatStep:i,contractSections:f,selectedTitle:c}=W(),[u,d]=h.useState(!0);return i!=="done"?null:e.jsxs("div",{className:"draft-container flex flex-col h-screen bg-gradient-to-br from-indigo-50 to-purple-50",children:[e.jsx("h1",{className:"text-4xl font-bold text-purple-800 my-4",children:c}),e.jsx(he,{steps:f,title:c}),e.jsx("div",{className:"border border-b-0 mb-2 border-purple-100"}),e.jsx("div",{className:"flex items-center justify-start position-relative h-0 ",children:e.jsx("button",{style:{position:"fixed",top:"105px"},onClick:()=>d(!u),className:"p-1 bg-purple-50 hover:bg-purple-100 rounded-full send-button z-10 position-sticky top-30",children:u?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[u&&e.jsx("div",{className:`${u?"w-1/2":"w-0"} border-r border-purple-100`,children:e.jsx(ve,{})}),e.jsx("div",{className:`transition-all duration-200 ${u?"w-1/2":"w-full"} `,style:{resize:"horizontal",overflow:"auto",minWidth:"300px"},children:e.jsx(be,{})})]})]})}const je=()=>{const[i,f]=h.useState([]),[c,u]=h.useState("all"),[d,p]=h.useState(""),[o,n]=h.useState(!0),[l,v]=h.useState(null);h.useEffect(()=>{(async()=>{try{const m=await fetch("/apcontract/contracts");if(m.ok){const s=await m.json(),x=new Map;s.ideas.forEach(a=>{var k,_,O,I,L,B;if(!x.has(a.session_id)){const A=(()=>{var g;const T=a.all_drafts||a.drafts||{};if(Object.keys(T).length>0){let N="";if(Object.entries(T).forEach(([C,D])=>{D&&D.trim()&&(N+=`## ${C}

${D}

`)}),N.trim())return N}const F=a.conversation_history||((g=a.metadata)==null?void 0:g.conversation_history)||[];if(F&&F.length>0){const N=F.filter(C=>C.role==="user"||C.type==="user").map(C=>C.content||C.message||"").filter(C=>C&&C.length>10);if(N.length>0)return N.join(`

`)}return a.idea||a.rephrased_idea||a.description||"Contract details will be available after completion"})();x.set(a.session_id,{id:a.session_id,title:a.title||"Untitled Contract",department:((k=a.metadata)==null?void 0:k.department)||"General",status:a.status||"submitted",submittedBy:((_=a.metadata)==null?void 0:_.submitted_by)||"Anonymous",submittedDate:(O=a.metadata)!=null&&O.created_at?new Date(a.metadata.created_at).toISOString().split("T")[0]:"Unknown",evaluationScore:((I=a.metadata)==null?void 0:I.evaluation_score)||a.evaluation_score||a.ai_score||null,reviewerFeedback:((L=a.metadata)==null?void 0:L.reviewer_feedback)||a.reviewer_feedback||null,summary:A,category:((B=a.metadata)==null?void 0:B.category)||"General"})}});const r=Array.from(x.values());f(r)}else console.error("Failed to fetch contracts:",m.status),f([])}catch(m){console.error("Error fetching contracts:",m),f([])}finally{n(!1)}})()},[]);const j=i.filter(t=>{const m=c==="all"||t.status===c,s=t.title.toLowerCase().includes(d.toLowerCase())||t.summary.toLowerCase().includes(d.toLowerCase())||t.department.toLowerCase().includes(d.toLowerCase());return m&&s}),w=t=>{switch(t){case"submitted":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=t=>{switch(t){case"AI & Automation":return"bg-purple-100 text-purple-800";case"Analytics & Reporting":return"bg-indigo-100 text-indigo-800";case"Process Automation":return"bg-teal-100 text-teal-800";default:return"bg-gray-100 text-gray-800"}},S={total:i.length,pending_review:i.filter(t=>t.status==="submitted").length,approved:i.filter(t=>t.status==="approved").length,rejected:i.filter(t=>t.status==="rejected").length};return o?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading contract catalog..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Contracts"}),e.jsx("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:S.total})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending Review"}),e.jsx("dd",{className:"mt-1 text-3xl font-semibold text-yellow-600",children:S.pending_review})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Approved"}),e.jsx("dd",{className:"mt-1 text-3xl font-semibold text-green-600",children:S.approved})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Rejected"}),e.jsx("dd",{className:"mt-1 text-3xl font-semibold text-red-600",children:S.rejected})]})})]}),e.jsx("div",{className:"mb-6 bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search contracts by title, department, or description...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:d,onChange:t=>p(t.target.value)})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:c,onChange:t=>u(t.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(t=>e.jsx(K.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 cursor-pointer",onClick:()=>v(t),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2 flex-1 mr-2",children:t.title}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${w(t.status)}`,children:t.status.replace("_"," ")})]}),e.jsx("div",{className:"mb-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${b(t.category)}`,children:t.category})}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Department:"}),e.jsx("span",{className:"font-medium",children:t.department})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Submitted by:"}),e.jsx("span",{className:"font-medium",children:t.submittedBy})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Date:"}),e.jsx("span",{className:"font-medium",children:t.submittedDate})]}),t.evaluationScore&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Score:"}),e.jsxs("span",{className:`font-medium ${t.evaluationScore>=70?"text-green-600":t.evaluationScore>=50?"text-yellow-600":"text-red-600"}`,children:[t.evaluationScore,"/100"]})]})]})]})},t.id))}),l&&e.jsx("div",{className:"fixed inset-0 overflow-y-auto z-50",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:l.title}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${w(l.status)}`,children:l.status.replace("_"," ")}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${b(l.category)}`,children:l.category})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Department:"})," ",l.department]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Submitted by:"})," ",l.submittedBy]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",l.submittedDate]}),l.evaluationScore&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Score:"}),e.jsxs("span",{className:`ml-1 ${l.evaluationScore>=70?"text-green-600":l.evaluationScore>=50?"text-yellow-600":"text-red-600"}`,children:[l.evaluationScore,"/100"]})]})]}),(l.status==="approved"||l.status==="rejected")&&e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Reviewer Evaluation"}),l.evaluationScore&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Score:"}),e.jsxs("span",{className:`ml-2 ${l.evaluationScore>=70?"text-green-600":l.evaluationScore>=50?"text-yellow-600":"text-red-600"}`,children:[l.evaluationScore,"/100"]})]}),l.reviewerFeedback&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Feedback:"}),e.jsx("div",{className:"mt-1 bg-gray-50 p-3 rounded-md",children:e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:l.reviewerFeedback})})]})]})]}),e.jsx("div",{className:"mt-5 sm:mt-6",children:e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm",onClick:()=>v(null),children:"Close"})})]})]})}),j.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No contracts found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:d||c!=="all"?"Try adjusting your search or filter criteria":"Be the first to submit a contract!"})]})]})})})},ye=()=>{const[i,f]=h.useState([]),[c,u]=h.useState(null),[d,p]=h.useState(!0),[o,n]=h.useState("ai-reviewer"),[l,v]=h.useState(null);h.useEffect(()=>{(async()=>{try{const m=await fetch("/apcontract/contracts");if(m.ok){const s=await m.json(),x=new Map;s.ideas.forEach(a=>{var k,_,O,I,L;if(!x.has(a.session_id)&&(a.status==="submitted"||a.status==="completed"||a.status==="in_progress")){const B=()=>{console.log("=== DEBUG: Processing contract ==="),console.log("Contract title:",a.title),console.log("Contract session_id:",a.session_id),console.log("Contract status:",a.status),console.log("All drafts:",a.all_drafts),console.log("Drafts:",a.drafts),console.log("Contract content:",a.idea),console.log("Rephrased contract:",a.rephrased_idea),console.log("Original contract:",a.original_idea);const A=a.drafts||a.all_drafts||{};if(console.log("Using drafts object:",A),console.log("Drafts keys:",Object.keys(A)),Object.keys(A).length>0){console.log("Found drafts sections:",Object.keys(A));let T="";return Object.entries(A).forEach(([F,g])=>{console.log(`Section: ${F}, Draft content:`,g),console.log(`Section ${F} has content:`,g&&g.trim()&&g!=="No draft content available"),g&&g.trim()&&g!=="No draft content available"&&(T+=`## ${F}

${g}

`)}),T.trim()?(console.log("âœ… SUCCESS: Returning full draft content"),T):(console.log("âš ï¸ WARNING: Drafts exist but no valid content found - using fallback"),`## Contract Summary

This contract has draft sections but the content appears to be empty or placeholder text.

**Available Sections:** ${Object.keys(A).join(", ")}

Please check if the Q&A process was completed properly.`)}else return console.log("âš ï¸ WARNING: No drafts found in contract object - using fallback content"),a.idea&&a.idea.trim()&&a.idea!=="No draft content available"?(console.log("âœ… Using contract content as fallback"),a.idea):a.rephrased_idea&&a.rephrased_idea.trim()?(console.log("âœ… Using rephrased contract as fallback"),a.rephrased_idea):a.original_idea&&a.original_idea.trim()&&a.original_idea!=="No draft content available"?(console.log("âœ… Using original contract as fallback"),a.original_idea):(console.log("âš ï¸ No content available - using default message"),"Contract document content will be available after completing the Q&A process. This contract is still in progress or the draft content has not been generated yet.")};let M;try{M=B()}catch(A){console.error("Error generating draft:",A),M=`Error generating draft content: ${A.message}

Please check the browser console for detailed debug information.`}x.set(a.session_id,{id:a.session_id,title:a.title||"Untitled Contract",department:((k=a.metadata)==null?void 0:k.department)||"Legal",status:a.status==="completed"||a.status==="in_progress"?"submitted":a.status||"submitted",submittedBy:((_=a.metadata)==null?void 0:_.submitted_by)||"Anonymous",submittedDate:(O=a.metadata)!=null&&O.created_at?new Date(a.metadata.created_at).toISOString().split("T")[0]:"Unknown",evaluationScore:((I=a.metadata)==null?void 0:I.evaluation_score)||a.evaluation_score||null,reviewerFeedback:((L=a.metadata)==null?void 0:L.reviewer_feedback)||a.reviewer_feedback||null,aiScore:a.ai_score||null,aiFeedback:a.ai_feedback||null,aiStrengths:a.ai_strengths||[],aiImprovements:a.ai_improvements||[],aiRiskLevel:a.ai_risk_level||"Medium",summary:M})}});const r=Array.from(x.values());f(r)}else console.error("Failed to fetch contracts:",m.status),f([])}catch(m){console.error("Error fetching contracts:",m),f([])}finally{p(!1)}})()},[]);const j=async(t,m,s,x)=>{try{(await fetch("/apcontract/update-contract-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t,status:x,evaluation_score:m,reviewer_feedback:s})})).ok?(f(a=>a.map(k=>k.id===t?{...k,evaluationScore:m,status:x,reviewerFeedback:s}:k)),u(null),alert("Contract evaluation saved successfully!")):alert("Failed to save evaluation. Please try again.")}catch(r){console.error("Error updating contract status:",r),alert("Error saving evaluation. Please try again.")}},w=t=>{switch(t){case"submitted":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=t=>t>=80?"text-green-600":t>=60?"text-yellow-600":"text-red-600",S=t=>{switch(t){case"Low":return"text-green-600 bg-green-100";case"Medium":return"text-yellow-600 bg-yellow-100";case"High":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return d?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading contracts..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5 py-4",children:[e.jsx("div",{className:"bg-gray-50 overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Contracts for Review"}),e.jsx("dd",{className:"mt-1 text-2xl font-semibold text-gray-900",children:i.length})]})}),e.jsx("div",{className:"bg-gray-50 overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending Review"}),e.jsx("dd",{className:"mt-1 text-2xl font-semibold text-yellow-600",children:i.filter(t=>t.status==="submitted").length})]})}),e.jsx("div",{className:"bg-gray-50 overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Approved"}),e.jsx("dd",{className:"mt-1 text-2xl font-semibold text-green-600",children:i.filter(t=>t.status==="approved").length})]})}),e.jsx("div",{className:"bg-gray-50 overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Rejected"}),e.jsx("dd",{className:"mt-1 text-2xl font-semibold text-red-600",children:i.filter(t=>t.status==="rejected").length})]})}),e.jsx("div",{className:"bg-gray-50 overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg. Score"}),e.jsx("dd",{className:"mt-1 text-2xl font-semibold text-green-600",children:Math.round(i.filter(t=>t.evaluationScore).reduce((t,m)=>t+m.evaluationScore,0)/(i.filter(t=>t.evaluationScore).length||1))})]})})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>n("ai-reviewer"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${o==="ai-reviewer"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"AI Legal Reviewer"}),e.jsx("button",{onClick:()=>n("contract-review"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${o==="contract-review"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Human Contract Review"})]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto py-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"px-4 sm:px-0",children:[o==="ai-reviewer"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Legal Reviewer"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Contracts are automatically scored by AI when submitted"})]}),e.jsx("div",{className:"text-sm text-gray-600",children:e.jsx("p",{children:"All contracts are automatically evaluated by AI as soon as they are uploaded. Click on any contract to view detailed AI legal feedback, scores, and risk assessments."})})]}),e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"AI-Scored Contracts"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Click on any contract to view detailed AI legal feedback"})]}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[i.map(t=>e.jsx(K.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"px-4 py-4 hover:bg-gray-50 cursor-pointer",onClick:()=>v(t),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-indigo-600 truncate",children:t.title}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex gap-2",children:t.aiScore!==null?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${b(t.aiScore)} bg-opacity-20`,children:["AI Score: ",t.aiScore,"/100"]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${S(t.aiRiskLevel)}`,children:["Risk: ",t.aiRiskLevel]})]}):e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:"AI Score: Pending"})})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("strong",{children:"Department:"})," ",t.department]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("strong",{children:"Submitted by:"})," ",t.submittedBy]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("strong",{children:"Date:"})," ",t.submittedDate]})]})]}),e.jsx("div",{className:"ml-5 flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})},t.id)),i.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No contracts available"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Submit a contract to see AI scores and legal feedback."})]})]})]})]}),o==="contract-review"&&e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Contract Review"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Review and evaluate submitted contracts"})]}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[i.map(t=>e.jsx(K.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"px-4 py-4 hover:bg-gray-50 cursor-pointer",onClick:()=>u(t),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-indigo-600 truncate",children:t.title}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${w(t.status)}`,children:t.status.replace("_"," ")})})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("strong",{children:"Department:"})," ",t.department]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("strong",{children:"Submitted by:"})," ",t.submittedBy]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("strong",{children:"Date:"})," ",t.submittedDate]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:async m=>{m.stopPropagation();try{const{jsPDF:s}=await ee(async()=>{const{jsPDF:k}=await import("./jspdf.es.min-BZUs-xJO.js").then(_=>_.j);return{jsPDF:k}},[]),x=new s;let r=20;x.setFontSize(20),x.setFont(void 0,"bold"),x.text(t.title,20,r),r+=15,x.setFontSize(12),x.setFont(void 0,"normal"),x.text(`Department: ${t.department}`,20,r),r+=8,x.text(`Submitted by: ${t.submittedBy}`,20,r),r+=8,x.text(`Date: ${t.submittedDate}`,20,r),r+=8,x.text(`Status: ${t.status}`,20,r),r+=8,t.evaluationScore&&(x.text(`Evaluation Score: ${t.evaluationScore}/100`,20,r),r+=8),r+=10,x.setFontSize(14),x.setFont(void 0,"bold"),x.text("Contract Document Content:",20,r),r+=10,x.setFontSize(10),x.setFont(void 0,"normal"),t.summary&&t.summary.trim()&&!t.summary.includes("Contract document content will be available after completing the Q&A process")?x.splitTextToSize(t.summary,170).forEach(_=>{r>270&&(x.addPage(),r=20),x.text(_,20,r),r+=6}):["âŒ ERROR: No draft content available for PDF generation","","Debug Information:",`- Contract Title: ${t.title}`,`- Contract Status: ${t.status}`,`- Has Summary: ${!!t.summary}`,`- Summary Length: ${t.summary?t.summary.length:0}`,"","Possible Issues:","1. The contract may not have completed the Q&A process","2. Draft content may not have been saved to database","3. The draft generation process may have failed","","Please check the browser console for detailed debug logs."].forEach(_=>{r>270&&(x.addPage(),r=20),x.text(_,20,r),r+=6}),x.save(`${t.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_contract_document.pdf`)}catch(s){console.error("Error generating PDF:",s),alert(`PDF Generation Error: ${s.message}

Check browser console for detailed debug information.`)}},className:"bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded-md text-xs font-medium transition-colors duration-200",children:"ðŸ“„ Download as PDF"})}),t.evaluationScore&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Evaluation Score: ",e.jsxs("span",{className:"text-green-600",children:[t.evaluationScore,"/100"]})]})})]}),e.jsx("div",{className:"ml-5 flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})},t.id)),i.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No contracts submitted"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by submitting your first contract."})]})]})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 overflow-y-auto z-50",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:[c.status==="approved"||c.status==="rejected"?"Edit Evaluation":"Evaluate Contract",": ",c.title]}),c.status==="approved"||c.status==="rejected"?e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${w(c.status)}`,children:c.status.replace("_"," ")}):null]}),c.evaluationScore&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-md",children:[e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Current Score:"})," ",c.evaluationScore,"/100"]}),c.reviewerFeedback&&e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[e.jsx("strong",{children:"Current Feedback:"})," ",c.reviewerFeedback]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Evaluation Score (0-100)"}),e.jsx("input",{type:"number",min:"0",max:"100",defaultValue:c.evaluationScore||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter score",id:"scoreInput"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reviewer Feedback"}),e.jsx("textarea",{rows:"4",defaultValue:c.reviewerFeedback||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Provide legal feedback and suggestions...",id:"feedbackInput"})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-cols-3 sm:gap-3 sm:grid-flow-row-dense",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:text-sm",onClick:()=>{const t=parseInt(document.getElementById("scoreInput").value)||0,m=document.getElementById("feedbackInput").value;j(c.id,t,m,"approved")},children:c.status==="approved"?"Update Approval":"Approve"}),e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:text-sm",onClick:()=>{const t=parseInt(document.getElementById("scoreInput").value)||0,m=document.getElementById("feedbackInput").value;j(c.id,t,m,"rejected")},children:c.status==="rejected"?"Update Rejection":"Reject"}),e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm",onClick:()=>u(null),children:"Cancel"})]})]})]})}),l&&e.jsx("div",{className:"fixed inset-0 overflow-y-auto z-50",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["AI Legal Review: ",l.title]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${b(l.aiScore)} bg-opacity-20`,children:["AI Score: ",l.aiScore,"/100"]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${S(l.aiRiskLevel)}`,children:["Risk: ",l.aiRiskLevel]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"AI Legal Feedback"}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-700 leading-relaxed",children:l.aiFeedback||"No AI legal feedback available for this contract."})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-2",children:"Contract Details"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:e.jsx("strong",{children:"Department:"})}),e.jsx("span",{children:l.department})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:e.jsx("strong",{children:"Submitted by:"})}),e.jsx("span",{children:l.submittedBy})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:e.jsx("strong",{children:"Date:"})}),e.jsx("span",{children:l.submittedDate})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:e.jsx("strong",{children:"Status:"})}),e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${w(l.status)}`,children:l.status.replace("_"," ")})]}),l.evaluationScore&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:e.jsx("strong",{children:"Human Score:"})}),e.jsxs("span",{className:"text-green-600",children:[l.evaluationScore,"/100"]})]})]})]})]}),e.jsx("div",{className:"mt-5 sm:mt-6",children:e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm",onClick:()=>v(null),children:"Close"})})]})]})})]})},Q="/apcontract",we=async(i,f)=>{const{Document:c,Packer:u,Paragraph:d,TextRun:p}=await ee(async()=>{const{Document:b,Packer:S,Paragraph:t,TextRun:m}=await import("./index-C61u3LdB.js");return{Document:b,Packer:S,Paragraph:t,TextRun:m}},[]),o=(b,S)=>{const t=[];t.push(new d({children:[new p({text:b,bold:!0,color:"2F5496",size:32,font:"Calibri"})],spacing:{after:200}}));const m=S.split(/\n+/).filter(Boolean);for(const s of m)t.push(new d({children:[new p({text:s,size:22,font:"Calibri"})],spacing:{after:200,line:276}}));return t},n=new c({sections:[{properties:{},children:Object.entries(i).flatMap(([b,S])=>o(b,S))}]}),l=await u.toBlob(n),v=window.URL.createObjectURL(l),j=document.createElement("a"),w=f;j.href=v,j.download=`${w}.docx`,document.body.appendChild(j),j.click(),document.body.removeChild(j)},Ne=()=>{const[i,f]=h.useState(null),[c,u]=h.useState(""),[d,p]=h.useState(!1),[o,n]=h.useState(null),[l,v]=h.useState(""),[j,w]=h.useState(""),[b,S]=h.useState([]),[t,m]=h.useState({}),[s,x]=h.useState(!1),[r,a]=h.useState(null),[k,_]=h.useState(!1),O=g=>{const N=g.target.files[0];if(N){const C=[".docx",".doc",".pdf",".txt"],D=N.name.toLowerCase().slice(N.name.lastIndexOf("."));if(!C.includes(D)){v(`Invalid file type. Allowed types: ${C.join(", ")}`),f(null);return}f(N),v("")}},I=async()=>{if(!i&&!c.trim()){v("Please either upload a document or provide contract information in the text box");return}p(!0),v(""),n(null),S([]),m({}),x(!1),a(null),w("");try{const g=new FormData;i&&g.append("file",i),c.trim()&&g.append("additional_info",c.trim());const N=await fetch(`${Q}/generate-contract-with-questions`,{method:"POST",body:g});if(!N.ok){const D=await N.json();throw new Error(D.detail||"Contract generation failed")}const C=await N.json();n(C),w(C.session_id),C.missing_data&&C.missing_data.length>0&&S(C.missing_data),f(null),u(""),document.getElementById("content-file-input").value=""}catch(g){v(g.message||"An error occurred during contract generation"),F()}finally{p(!1)}},L=(g,N)=>{m(C=>({...C,[g]:N}))},B=async()=>{if(!(!j||b.length===0)){_(!0);try{const g={};b.forEach(D=>{const P=t[D.field]||"";P.trim()&&(g[D.field]=P)});const N=await fetch(`${Q}/submit-all-missing-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:j,missing_data_responses:g})});if(!N.ok){const D=await N.json();throw new Error(D.detail||"Failed to submit missing data")}const C=await N.json();C.type==="end"?(x(!0),console.log("Final contract received:",C.final_contract||C),a(C.final_contract||C)):v("Unexpected response from server")}catch(g){v("Failed to submit missing data: "+g.message)}finally{_(!1)}}},M=async()=>{if(j){_(!0);try{const g=await fetch(`${Q}/get-next-question`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:j})});if(!g.ok)throw new Error("Failed to generate final contract");const N=await g.json();N.type==="end"?(x(!0),a(N.final_contract||N)):v("Unexpected response from server")}catch(g){v("Failed to generate final contract: "+g.message)}finally{_(!1)}}},A=async()=>{if(r)try{console.log("Final contract structure:",r);const g=r.title||r.contract_title||"Generated Contract";let N={};if(r.sections&&Array.isArray(r.sections)?r.sections.forEach(E=>{E.heading&&E.content&&(N[E.heading]=E.content)}):r.drafts&&typeof r.drafts=="object"&&(N=r.drafts),console.log("Extracted drafts:",N),Object.keys(N).length===0){alert("No contract content found to save. Please try generating the contract again.");return}const C=Object.entries(N).map(([E,z])=>`## ${E}

${z}`).join(`

`);console.log("Saving contract to catalog:",{title:g,sections_count:Object.keys(N).length,completeDocument_length:C.length});const D={session_id:j,contract:{title:g,drafts:N,sections:r.sections||[]}},P=await fetch(`${Q}/save-contract`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(P.ok){const E=await P.json();alert(`Contract "${g}" saved successfully! It will now appear in the Contract Catalog for review.`),console.log("Contract saved with session ID:",E.session_id)}else{const E=await P.text();console.error("Save failed:",E),alert("Failed to save contract. Please check if the backend server is running.")}}catch(g){console.error("Error saving contract:",g),alert("Error saving contract. Please check if the backend server is running.")}},T=async()=>{if(r)try{console.log("Final contract structure for download:",r);const g=r.title||r.contract_title||"Generated Contract";let N="";if(r.sections&&Array.isArray(r.sections)?r.sections.forEach(P=>{P.heading&&P.content&&(N+=`## ${P.heading}

${P.content}

`)}):r.drafts&&typeof r.drafts=="object"&&Object.entries(r.drafts).forEach(([P,E])=>{N+=`## ${P}

${E}

`}),console.log("Formatted content for download:",N),!N.trim()){alert("No contract content found to download. Please try generating the contract again.");return}const C=`${g.replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_")}_Contract.docx`;let D={};r.sections&&Array.isArray(r.sections)?r.sections.forEach(P=>{P.heading&&P.content&&(D[P.heading]=P.content)}):r.drafts&&typeof r.drafts=="object"&&(D=r.drafts),await we(D,g)}catch(g){console.error("Error downloading contract:",g),alert("Error downloading contract. Please try again. Error details: "+g.message)}},F=()=>{w(""),S([]),m({}),x(!1),a(null),n(null)};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Contract Generation from Documents"}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 mb-6",children:[e.jsx("h3",{className:"text-green-800 font-semibold mb-2",children:"Upload Content & Generate Contract"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Upload your contract content/document. The AI will analyze the content, identify missing information, and generate a complete contract."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Contract Content Document"}),e.jsx("input",{id:"content-file-input",type:"file",accept:".docx,.doc,.pdf,.txt",onChange:O,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Supported formats: DOCX, DOC, PDF, TXT"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contract Information (Alternative to File Upload)"}),e.jsx("textarea",{value:c,onChange:g=>u(g.target.value),placeholder:"Type your contract information here. You can provide party names, contract duration, payment terms, obligations, or any other contract details. This can be used INSTEAD of uploading a document.",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",rows:"4"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Use this text box to provide contract information directly. You can use this INSTEAD of uploading a document, or in addition to it."})]}),l&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:e.jsx("p",{className:"text-red-700 text-sm",children:l})}),o&&!s&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-4",children:[e.jsx("h3",{className:"text-blue-800 font-semibold mb-2",children:"Document Analysis Complete"}),e.jsx("p",{className:"text-blue-700 text-sm",children:o.message}),o.extracted_info&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"text-blue-700 font-medium mb-2",children:"âœ… Information Found in Document:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[o.extracted_info.parties&&o.extracted_info.parties.length>0&&e.jsxs("div",{className:"text-green-600",children:["â€¢ Parties: ",o.extracted_info.parties.length," found"]}),o.extracted_info.key_terms>0&&e.jsxs("div",{className:"text-green-600",children:["â€¢ Key Terms: ",o.extracted_info.key_terms," found"]}),o.extracted_info.obligations>0&&e.jsxs("div",{className:"text-green-600",children:["â€¢ Obligations: ",o.extracted_info.obligations," found"]}),o.extracted_info.payment_terms&&Object.keys(o.extracted_info.payment_terms).length>0&&e.jsx("div",{className:"text-green-600",children:"â€¢ Payment Terms: Available"})]})]}),b.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("h4",{className:"text-orange-700 font-medium mb-2",children:["âš ï¸ Additional Information Needed (",b.length," fields):"]}),e.jsx("p",{className:"text-orange-600 text-sm",children:"Please provide the following additional information to complete the contract:"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[b.map((g,N)=>e.jsxs("div",{className:"border border-orange-200 rounded-md p-3 bg-orange-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-orange-800",children:g.description}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${g.priority==="high"?"bg-red-100 text-red-800":g.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:[g.priority||"medium"," priority"]})]}),e.jsx("textarea",{value:t[g.field]||"",onChange:C=>L(g.field,C.target.value),placeholder:`Enter ${g.field}...`,className:"w-full p-2 border border-orange-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500",rows:"2"}),g.reason&&e.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[e.jsx("strong",{children:"Why this is needed:"})," ",g.reason]})]},N)),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsxs("p",{className:"text-blue-700 text-sm",children:[e.jsx("strong",{children:"Note:"})," Only the most important missing fields are shown. If you have additional information, you can provide it in the text areas above."]})}),e.jsx("button",{onClick:B,disabled:k,className:"w-full bg-orange-600 text-white py-2 px-4 rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Processing...":"Generate Final Contract"})]})]}),o.missing_data_count===0&&b.length===0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"text-green-700 font-medium mb-2",children:"âœ… All Information Complete!"}),e.jsx("p",{className:"text-green-600 text-sm",children:"Great! Your document contains all the necessary information. You can now generate the complete contract."}),e.jsx("button",{onClick:M,className:"mt-3 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:"Generate Final Contract"})]}),o.session_id&&e.jsxs("p",{className:"text-blue-700 text-sm mt-2",children:["Session ID: ",o.session_id]})]}),s&&r&&e.jsxs("div",{className:"border border-green-200 rounded-md p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-green-800",children:"Contract Generated Successfully!"}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 mb-4",children:[e.jsx("p",{className:"text-green-700 text-sm mb-4",children:"Your contract has been generated successfully. You can now save it to the catalog or download it as a Word document."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.title&&e.jsxs("div",{className:"text-green-600",children:[e.jsx("strong",{children:"Title:"})," ",r.title]}),r.drafts&&e.jsxs("div",{className:"text-green-600",children:[e.jsx("strong",{children:"Sections:"})," ",Object.keys(r.drafts).length]}),r.session_id&&e.jsxs("div",{className:"text-green-600",children:[e.jsx("strong",{children:"Session ID:"})," ",r.session_id]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:A,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save to Catalog"}),e.jsx("button",{onClick:T,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:"Download Contract"})]})]}),!j&&e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:I,disabled:d||!i&&!c.trim(),className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Processing...":"Analyze Input & Identify Missing Data"})})]})},Se=()=>{const{setUserContext:i}=W(),[f,c]=h.useState({email:"",password:"",rememberMe:!1}),[u,d]=h.useState(!1),[p,o]=h.useState(""),n={"manager@company.com":{password:"password123",userContext:{user_id:"EMP001",department:"Legal",role:"Manager",location:"North America",language:"en"}},"lawyer@company.com":{password:"password123",userContext:{user_id:"EMP002",department:"Legal",role:"Lawyer",location:"Europe",language:"en"}},"director@company.com":{password:"password123",userContext:{user_id:"EMP003",department:"Business",role:"Director",location:"Asia Pacific",language:"en"}}},l=async w=>{w.preventDefault(),d(!0),o(""),await new Promise(S=>setTimeout(S,1e3));const b=n[f.email];b&&b.password===f.password?(i(b.userContext),localStorage.setItem("user_context",JSON.stringify(b.userContext))):o("Invalid email or password. Try: manager@company.com / password123"),d(!1)},v=w=>{const{name:b,value:S,type:t,checked:m}=w.target;c(s=>({...s,[b]:t==="checkbox"?m:S}))},j=w=>{c({email:w,password:"password123",rememberMe:!1})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to Contract Generation Platform"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Demo Login - This will be replaced with SSO integration"})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[p&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm",children:p}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:f.email,onChange:v,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your company email"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:f.password,onChange:v,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter password"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"rememberMe",name:"rememberMe",type:"checkbox",checked:f.rememberMe,onChange:v,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"rememberMe",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"#",className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:u?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign in"})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Quick Demo Logins"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsx("button",{onClick:()=>j("manager@company.com"),className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Login as Manager"}),e.jsx("button",{onClick:()=>j("lawyer@company.com"),className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Login as Lawyer"}),e.jsx("button",{onClick:()=>j("director@company.com"),className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Login as Director"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-md",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"SSO Integration Ready"}),e.jsx("p",{className:"text-xs text-blue-700",children:"This login page is designed to be easily replaced with your company's SSO provider. The user context system is already built and ready for auto-population."})]})]})})]})};function Ce(){const{initialChatStep:i,userContext:f,setUserContext:c}=W(),[u,d]=h.useState("contract-submission"),[p,o]=h.useState(!1);h.useEffect(()=>{const j=localStorage.getItem("user_context");if(j){const w=JSON.parse(j);c(w),o(!0)}},[c]),h.useEffect(()=>{o(!!f)},[f]);const n=()=>{c(null),localStorage.removeItem("user_context"),o(!1)};if(!p)return e.jsx(Se,{});const l=()=>e.jsx("nav",{className:"bg-white shadow-sm border-b sticky top-0 z-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Contract Generation Platform"})}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"hidden sm:flex sm:space-x-4",children:[e.jsx("button",{onClick:()=>d("contract-submission"),className:`${u==="contract-submission"?"text-blue-600 border-blue-500":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"} inline-flex items-center px-3 py-2 border-b-2 text-sm font-medium`,children:"Submit Contract"}),e.jsx("button",{onClick:()=>d("file-upload"),className:`${u==="file-upload"?"text-blue-600 border-blue-500":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"} inline-flex items-center px-3 py-2 border-b-2 text-sm font-medium`,children:"Upload Documents"}),e.jsx("button",{onClick:()=>d("contract-catalog"),className:`${u==="contract-catalog"?"text-blue-600 border-blue-500":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"} inline-flex items-center px-3 py-2 border-b-2 text-sm font-medium`,children:"Contract Catalog"}),e.jsx("button",{onClick:()=>d("contract-reviewer"),className:`${u==="contract-reviewer"?"text-blue-600 border-blue-500":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"} inline-flex items-center px-3 py-2 border-b-2 text-sm font-medium`,children:"Contract Reviewer"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:f==null?void 0:f.role}),e.jsx("span",{className:"mx-1",children:"â€¢"}),e.jsx("span",{children:f==null?void 0:f.department})]}),e.jsx("button",{onClick:n,className:"text-sm text-gray-500 hover:text-gray-700 px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50",children:"Logout"})]})]})]})})}),v=()=>{switch(u){case"contract-submission":return i!=="done"?e.jsx(se,{}):e.jsx(ae,{});case"file-upload":return e.jsx(Ne,{});case"contract-catalog":return e.jsx(je,{});case"contract-reviewer":return e.jsx(ye,{});default:return i!=="done"?e.jsx(se,{}):e.jsx(ae,{})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(l,{}),e.jsx("main",{children:v()})]})}function ke(){return e.jsx(ue,{children:e.jsx(Ce,{})})}oe(document.getElementById("root")).render(e.jsx(ke,{}));export{ee as _};
